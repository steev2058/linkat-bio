<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Linkat Admin</title>
  <style>
    body{font-family:system-ui,sans-serif;background:#f8fafc;padding:24px;color:#0f172a}
    h1,h2{margin:8px 0}
    .grid{display:grid;grid-template-columns:1fr;gap:16px;max-width:1100px}
    .card{background:#fff;padding:16px;border-radius:12px;box-shadow:0 4px 18px rgba(0,0,0,.05)}
    table{width:100%;border-collapse:collapse;font-size:14px}
    th,td{border-bottom:1px solid #e2e8f0;padding:8px;text-align:left}
    input,select,button{padding:8px;border-radius:8px;border:1px solid #cbd5e1}
    button{background:#0f172a;color:#fff;cursor:pointer}
    .muted{color:#64748b;font-size:14px}
  </style>
</head>
<body>
  <h1>Linkat Admin</h1>
  <p class="muted">Views: {{ total_views }} | Clicks: {{ total_clicks }}</p>
  <div class="grid">
    <div class="card">
      <h2>Create Voucher</h2>
      <form method="post" action="/admin/voucher/create">
        <select name="plan_type">
          <option value="PRO_1">PRO_1 ($1)</option>
          <option value="PRO_3">PRO_3 ($3)</option>
        </select>
        <select name="duration_days">
          <option value="30">30 days</option>
          <option value="90">90 days</option>
          <option value="365">365 days</option>
        </select>
        <button type="submit">Create</button>
      </form>
    </div>

    <div class="card">
      <h2>Vouchers</h2>
      <table>
        <tr><th>ID</th><th>Code</th><th>Plan</th><th>Days</th><th>Active</th><th>Redeemed By</th><th>Action</th></tr>
        {% for v in vouchers %}
        <tr>
          <td>{{ v.id }}</td><td>{{ v.code }}</td><td>{{ v.plan_type }}</td><td>{{ v.duration_days }}</td>
          <td>{{ v.is_active }}</td><td>{{ v.redeemed_by_user_id or '-' }}</td>
          <td>
            {% if v.is_active %}
            <form method="post" action="/admin/voucher/{{ v.id }}/disable"><button>Disable</button></form>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </table>
    </div>

    <div class="card">
      <h2>Users</h2>
      <table>
        <tr><th>ID</th><th>TG ID</th><th>Username</th><th>Plan</th><th>Expires</th></tr>
        {% for u in users %}<tr><td>{{ u.id }}</td><td>{{ u.tg_user_id }}</td><td>{{ u.username }}</td><td>{{ u.plan_type }}</td><td>{{ u.plan_expires_at or '-' }}</td></tr>{% endfor %}
      </table>
    </div>

    <div class="card">
      <h2>Pages</h2>
      <table>
        <tr><th>ID</th><th>User</th><th>Slug</th><th>Published</th><th>Name</th></tr>
        {% for p in pages %}<tr><td>{{ p.id }}</td><td>{{ p.user_id }}</td><td>{{ p.slug or '-' }}</td><td>{{ p.is_published }}</td><td>{{ p.display_name or '-' }}</td></tr>{% endfor %}
      </table>
    </div>
  </div>
</body>
</html>
